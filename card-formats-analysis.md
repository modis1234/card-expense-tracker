# 카드사 엑셀 포맷 분석

## 조사 대상 카드사
- [ ] 신한카드
- [ ] 삼성카드
- [ ] 현대카드
- [ ] KB국민카드
- [ ] 롯데카드

---

## 신한카드

### 다운로드 방법
- 웹사이트: 
- 경로: 
- 파일명 형식: 

### 엑셀 구조
| 항목 | 내용 |
|------|------|
| 헤더 시작 행 | (예: 1행, 3행) |
| 데이터 시작 행 | (예: 2행, 4행) |
| 총 컬럼 수 | |

### 컬럼 정보
| 순서 | 컬럼명 | 데이터 예시 | 데이터 타입 | 비고 |
|------|--------|-------------|-------------|------|
| 1 | 이용일자 | 2024-01-15 | 날짜 | YYYY-MM-DD |
| 2 | 이용시간 | 14:30:25 | 시간 | HH:MM:SS |
| 3 | 가맹점명 | 스타벅스 강남점 | 문자열 | |
| 4 | 이용금액 | 5,500 | 숫자 | 쉼표 포함 |
| 5 | 할부개월 | 일시불 | 문자열 | |
| 6 | 카드번호 | 1234-****-****-5678 | 문자열 | 마스킹 |

### 특이사항
- 병합된 셀 여부:
- 요약 행 존재 여부:
- 빈 행 존재 여부:
- 기타:

### 샘플 데이터 (첫 3행)
```
[여기에 실제 엑셀 데이터 복사]
```

---

## 삼성카드

### 다운로드 방법
- 웹사이트: 
- 경로: 
- 파일명 형식: 

### 엑셀 구조
| 항목 | 내용 |
|------|------|
| 헤더 시작 행 | |
| 데이터 시작 행 | |
| 총 컬럼 수 | |

### 컬럼 정보
| 순서 | 컬럼명 | 데이터 예시 | 데이터 타입 | 비고 |
|------|--------|-------------|-------------|------|
| | | | | |

### 특이사항
- 

### 샘플 데이터 (첫 3행)
```
[여기에 실제 엑셀 데이터 복사]
```

---

## 현대카드

### 다운로드 방법
- 웹사이트: 현대카드 앱/웹
- 경로: 이용내역 → 엑셀 다운로드
- 파일명 형식: `hundai.xlsx` (사용자 지정)

### 엑셀 구조
| 항목 | 내용 |
|------|------|
| 헤더 시작 행 | 1-3행 (메타 정보) |
| 컬럼 헤더 행 | 5행 |
| 데이터 시작 행 | 6행 |
| 총 컬럼 수 | 12개 |

### 컬럼 정보
| 순서 | 컬럼명 | 데이터 예시 | 데이터 타입 | 비고 |
|------|--------|-------------|-------------|------|
| 1 | 이용일 | 2026.01.28 | 날짜 | YYYY.MM.DD |
| 2 | 카드번호 | 4049-4700-0662-7012 | 문자열 | 전체 번호 |
| 3 | 가맹점명 | 오토케어멤버십 | 문자열 | |
| 4 | 승인 금액 | 8,900 | 숫자 | 쉼표 포함 |
| 5 | 이용 금액 | 8,900 | 숫자 | 실제 결제 금액 |
| 6 | 부가세 | 0 | 숫자 | |
| 7 | 관계 | 본인 | 문자열 | 본인/가족 |
| 8 | 할부 | (비어있음) | 문자열 | 일시불은 빈 값 |
| 9 | 상태 | 정상 | 문자열 | 정상/취소 |
| 10 | 가맹점번호 | 870-452421 | 문자열 | |
| 11 | 사업자등록번호 | 214-81-65071 | 문자열 | |
| 12 | (추가 컬럼) | | | |

### 특이사항
- 상단 3행에 메타 정보 포함
  - 1행: "현대카드 이용내역"
  - 2행: "기준 일자 : 2025년 12월 30일 ~ 2026년 01월 30일"
  - 3행: "회원 정보 : 이*훈 (900303)"
- 날짜 형식: `YYYY.MM.DD` (점으로 구분)
- 금액에 쉼표 포함
- 카드번호 전체 노출 (마스킹 없음)
- 사업자등록번호 포함 (다른 카드사에 없는 정보)

### 샘플 데이터 (첫 3행)
```
이용일         카드번호              가맹점명                승인금액  이용금액  부가세  관계  할부  상태  가맹점번호    사업자등록번호
2026.01.28    4049-4700-0662-7012   오토케어멤버십          8,900    8,900    0      본인        정상  870-452421   214-81-65071
2026.01.25    4049-4700-0662-7012   메가박스중앙금정AK...   14,900   14,900   0      본인        정상  153-941750   365-85-02071
2026.01.25    4049-4700-0662-7012   (주)스마트로-군포...    2,400    2,400    0      본인        정상  151-936484   217-81-14493
```

---

## KB국민카드

### 다운로드 방법
- 웹사이트: 
- 경로: 
- 파일명 형식: 

### 엑셀 구조
| 항목 | 내용 |
|------|------|
| 헤더 시작 행 | |
| 데이터 시작 행 | |
| 총 컬럼 수 | |

### 컬럼 정보
| 순서 | 컬럼명 | 데이터 예시 | 데이터 타입 | 비고 |
|------|--------|-------------|-------------|------|
| | | | | |

### 특이사항
- 

### 샘플 데이터 (첫 3행)
```
[여기에 실제 엑셀 데이터 복사]
```

---

## 롯데카드

### 다운로드 방법
- 웹사이트: 
- 경로: 
- 파일명 형식: 

### 엑셀 구조
| 항목 | 내용 |
|------|------|
| 헤더 시작 행 | |
| 데이터 시작 행 | |
| 총 컬럼 수 | |

### 컬럼 정보
| 순서 | 컬럼명 | 데이터 예시 | 데이터 타입 | 비고 |
|------|--------|-------------|-------------|------|
| | | | | |

### 특이사항
- 

### 샘플 데이터 (첫 3행)
```
[여기에 실제 엑셀 데이터 복사]
```

---

## 공통 필드 분석

### 모든 카드사 공통 필드
| 필드명 (표준화) | 신한 | 삼성 | 현대 | KB | 롯데 |
|----------------|------|------|------|-----|------|
| 거래일자 | 이용일자 | | | | |
| 가맹점명 | 가맹점명 | | | | |
| 거래금액 | 이용금액 | | | | |
| 할부개월 | 할부개월 | | | | |

### 카드사별 고유 필드
- 신한: 
- 삼성: 
- 현대: 
- KB: 
- 롯데: 

---

## 파싱 전략

### 1단계: 카드사 식별
```
파일명 패턴 또는 헤더 구조로 카드사 자동 감지
```

### 2단계: 데이터 추출
```
- 헤더 행 찾기
- 데이터 시작 행 찾기
- 컬럼 매핑
```

### 3단계: 데이터 정규화
```
- 날짜 포맷 통일 (YYYY-MM-DD)
- 금액 포맷 통일 (숫자만, 쉼표 제거)
- 가맹점명 정제
```

---

## 다음 단계
- [ ] 실제 샘플 파일 수집
- [ ] 각 카드사별 상세 분석 완료
- [ ] 파싱 로직 설계
- [ ] 테스트 데이터 생성
